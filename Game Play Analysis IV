select
    round(
        count(distinct case when event_date = date_add(first_login, interval 1 day) then player_id else null end) * 1.0 
        / count(distinct player_id)
    , 2) as fraction
from (
    select
        player_id,
        event_date,
        min(event_date) over (partition by player_id) as first_login
    from
        activity
) as t;
